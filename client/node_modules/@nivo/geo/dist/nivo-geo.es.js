import{useMemo as e,memo as o,useCallback as r,Fragment as i,useRef as t,useEffect as n}from"react";import{useTheme as a,guessQuantizeColorScale as u,quantizeColorScalePropType as l,useDimensions as d,SvgWrapper as c,withContainer as f,ResponsiveWrapper as s,getRelativeCursor as h,bindDefs as p}from"@nivo/core";import{BasicTooltip as v,useTooltip as g}from"@nivo/tooltip";import m from"prop-types";import{useInheritedColor as C,inheritedColorPropType as b}from"@nivo/colors";import y from"lodash/isFunction";import R from"lodash/get";import{format as j}from"d3-format";import{geoAzimuthalEqualArea as q,geoAzimuthalEquidistant as w,geoGnomonic as T,geoOrthographic as M,geoStereographic as W,geoEqualEarth as k,geoEquirectangular as F,geoMercator as O,geoTransverseMercator as L,geoNaturalEarth1 as E,geoPath as S,geoGraticule as G,geoContains as x}from"d3-geo";import{useQuantizeColorScaleLegendData as B,BoxLegendSvg as P,renderLegendToCanvas as N}from"@nivo/legends";import{jsx as H}from"react/jsx-runtime";function I(){return I=Object.assign?Object.assign.bind():function(e){for(var o=1;o<arguments.length;o++){var r=arguments[o];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},I.apply(this,arguments)}var D={azimuthalEqualArea:q,azimuthalEquidistant:w,gnomonic:T,orthographic:M,stereographic:W,equalEarth:k,equirectangular:F,mercator:O,transverseMercator:L,naturalEarth1:E},z=function(o){var r=o.width,i=o.height,t=o.projectionType,n=o.projectionScale,u=o.projectionTranslation,l=o.projectionRotation,d=o.fillColor,c=o.borderWidth,f=o.borderColor,s=e((function(){return D[t]().scale(n).translate([r*u[0],i*u[1]]).rotate(l)}),[r,i,t,n,u[0],u[1],l[0],l[1],l[2]]),h=e((function(){return S(s)}),[s]),p=e((function(){return G()})),v=a(),g=e((function(){return"function"==typeof c?c:function(){return c}}),[c]),m=C(f,v),b=e((function(){return"function"==typeof d?d:function(){return d}}),[d]);return{projection:s,path:h,graticule:p,getBorderWidth:g,getBorderColor:m,getFillColor:b}},K=function(o){var r=o.features,i=o.data,t=o.match,n=o.label,a=o.value,l=o.valueFormat,d=o.colors,c=o.unknownColor,f=o.domain,s=e((function(){return y(t)?t:function(e,o){var r=R(e,t),i=R(o,t);return r&&r===i}}),[t]),h=e((function(){return y(n)?n:function(e){return R(e,n)}}),[n]),p=e((function(){return y(a)?a:function(e){return R(e,a)}}),[a]),v=e((function(){return void 0===l?function(e){return e}:y(l)?l:j(l)}),[l]),g=e((function(){return u(d).domain(f)}),[d,f]),m=e((function(){return function(e){return void 0===e.value?c:g(e.value)}}),[g,c]),C=e((function(){return r.map((function(e){var o=i.find((function(o){return s(e,o)})),r=p(o);if(o){var t=I({},e,{data:o,value:r,formattedValue:v(r)});return t.color=m(t),t.label=h(t),t}return e}))}),[r,i,s,p,v,m]),b=B({scale:g,valueFormat:v});return{colorScale:g,getFillColor:m,boundFeatures:C,valueFormatter:v,legendData:b}},V=o((function(e){var o=e.feature;return void 0===o.data?null:H(v,{id:o.label,color:o.color,enableChip:!0,value:o.formattedValue})}));V.propTypes={feature:m.object.isRequired},V.displayName="ChoroplethTooltip";var A={features:m.arrayOf(m.shape({id:m.string.isRequired,type:m.oneOf(["Feature"]).isRequired,properties:m.object,geometry:m.object.isRequired})).isRequired,projectionType:m.oneOf(Object.keys(D)).isRequired,projectionScale:m.number.isRequired,projectionTranslation:m.arrayOf(m.number).isRequired,projectionRotation:m.arrayOf(m.number).isRequired,fillColor:m.oneOfType([m.string,m.func]).isRequired,borderWidth:m.oneOfType([m.number,m.func]).isRequired,borderColor:b.isRequired,enableGraticule:m.bool.isRequired,graticuleLineWidth:m.number.isRequired,graticuleLineColor:m.string.isRequired,isInteractive:m.bool.isRequired,onMouseEnter:m.func.isRequired,onMouseMove:m.func.isRequired,onMouseLeave:m.func.isRequired,onClick:m.func.isRequired,tooltip:m.any,layers:m.arrayOf(m.oneOfType([m.oneOf(["graticule","features"]),m.func])).isRequired},J=I({},A,{role:m.string.isRequired}),Q=I({pixelRatio:m.number.isRequired},A),U={data:m.arrayOf(m.object).isRequired,match:m.oneOfType([m.string,m.func]).isRequired,label:m.oneOfType([m.string,m.func]).isRequired,value:m.oneOfType([m.string,m.func]).isRequired,valueFormat:m.oneOfType([m.string,m.func]),colors:l.isRequired,domain:m.arrayOf(m.number).isRequired,unknownColor:m.string.isRequired,layers:m.arrayOf(m.oneOfType([m.oneOf(["graticule","features","legends"]),m.func])).isRequired},X=I({},J,U,{role:m.string.isRequired}),Y=I({},Q,U),Z={projectionType:"mercator",projectionScale:100,projectionTranslation:[.5,.5],projectionRotation:[0,0,0],enableGraticule:!1,graticuleLineWidth:.5,graticuleLineColor:"#999999",fillColor:"#dddddd",borderWidth:0,borderColor:"#000000",isInteractive:!0,onMouseEnter:function(){},onMouseLeave:function(){},onMouseMove:function(){},onClick:function(){},layers:["graticule","features"],legends:[],fill:[],defs:[]},$=I({},Z,{role:"img"}),_=I({},Z,{pixelRatio:"undefined"!=typeof window&&window.devicePixelRatio||1}),ee={match:"id",label:"id",value:"value",colors:"PuBuGn",unknownColor:"#999",tooltip:V,layers:["graticule","features","legends"]},oe=I({},$,ee,{role:"img"}),re=I({},_,ee),ie=o((function(e){var o=e.path,r=e.graticule,i=e.lineWidth,t=e.lineColor;return H("path",{fill:"none",strokeWidth:i,stroke:t,d:o(r())})}));ie.propTypes={path:m.func.isRequired,graticule:m.func.isRequired,lineWidth:m.number.isRequired,lineColor:m.string.isRequired},ie.displayName="GeoGraticule";var te=o((function(e){var o,r=e.feature,i=e.path,t=e.fillColor,n=e.borderWidth,a=e.borderColor,u=e.onClick,l=e.onMouseEnter,d=e.onMouseMove,c=e.onMouseLeave;return H("path",{fill:null!=(o=null==r?void 0:r.fill)?o:t,strokeWidth:n,stroke:a,strokeLinejoin:"bevel",d:i(r),onMouseEnter:function(e){return l(r,e)},onMouseMove:function(e){return d(r,e)},onMouseLeave:function(e){return c(r,e)},onClick:function(e){return u(r,e)}},r.id)}));te.propTypes={feature:m.shape({id:m.string.isRequired,type:m.oneOf(["Feature"]).isRequired,properties:m.object,geometry:m.object.isRequired}).isRequired,path:m.func.isRequired,fillColor:m.string.isRequired,borderWidth:m.number.isRequired,borderColor:m.string.isRequired,onMouseEnter:m.func.isRequired,onMouseMove:m.func.isRequired,onMouseLeave:m.func.isRequired,onClick:m.func.isRequired},te.displayName="GeoMapFeature";var ne=o((function(e){var o=e.width,t=e.height,n=e.margin,u=e.features,l=e.layers,f=void 0===l?["graticule","features"]:l,s=e.projectionType,h=void 0===s?"mercator":s,p=e.projectionScale,v=void 0===p?100:p,m=e.projectionTranslation,C=void 0===m?[.5,.5]:m,b=e.projectionRotation,y=void 0===b?[0,0,0]:b,R=e.fillColor,j=void 0===R?"#dddddd":R,q=e.borderWidth,w=void 0===q?0:q,T=e.borderColor,M=void 0===T?"#000000":T,W=e.enableGraticule,k=void 0!==W&&W,F=e.graticuleLineWidth,O=void 0===F?.5:F,L=e.graticuleLineColor,E=void 0===L?"#999999":L,S=e.isInteractive,G=void 0===S||S,x=e.onClick,B=void 0===x?function(){}:x,P=e.tooltip,N=e.role,I=void 0===N?"img":N,D=d(o,t,n),K=D.margin,V=D.outerWidth,A=D.outerHeight,J=z({width:o,height:t,projectionType:h,projectionScale:v,projectionTranslation:C,projectionRotation:y,fillColor:j,borderWidth:w,borderColor:M}),Q=J.graticule,U=J.path,X=J.getFillColor,Y=J.getBorderWidth,Z=J.getBorderColor,$=a(),_=g(),ee=_.showTooltipFromEvent,oe=_.hideTooltip,re=r((function(e,o){return G&&B&&B(e,o)}),[G,B]),ne=r((function(e,o){return G&&P&&ee(H(P,{feature:e}),o)}),[G,ee,P]),ae=r((function(e,o){return G&&P&&ee(H(P,{feature:e}),o)}),[G,ee,P]),ue=r((function(){return G&&oe()}),[G,oe]);return H(c,{width:V,height:A,margin:K,theme:$,role:I,children:f.map((function(o,r){return"graticule"===o?!0!==k?null:H(ie,{path:U,graticule:Q,lineWidth:O,lineColor:E},"graticule"):"features"===o?H(i,{children:u.map((function(e){return H(te,{feature:e,path:U,fillColor:X(e),borderWidth:Y(e),borderColor:Z(e),onMouseEnter:ne,onMouseMove:ae,onMouseLeave:ue,onClick:re},e.id)}))},"features"):H(i,{children:o(e)},r)}))})}));ne.displayName="GeoMap",ne.propTypes=J;var ae=f(ne),ue=function(e){return H(s,{children:function(o){var r=o.width,i=o.height;return H(ae,I({width:r,height:i},e))}})},le=function(e,o,r,i){var t=h(o,e),n=t[0],a=t[1];return r.find((function(e){return x(e,i.invert([n,a]))}))},de=o((function(e){var o=e.width,i=e.height,u=e.margin,l=e.pixelRatio,c=void 0===l?"undefined"!=typeof window&&window.devicePixelRatio||1:l,f=e.features,s=e.layers,h=e.projectionType,p=void 0===h?"mercator":h,v=e.projectionScale,m=void 0===v?100:v,C=e.projectionTranslation,b=void 0===C?[.5,.5]:C,y=e.projectionRotation,R=void 0===y?[0,0,0]:y,j=e.fillColor,q=void 0===j?"#dddddd":j,w=e.borderWidth,T=void 0===w?0:w,M=e.borderColor,W=void 0===M?"#000000":M,k=e.enableGraticule,F=void 0!==k&&k,O=e.graticuleLineWidth,L=void 0===O?.5:O,E=e.graticuleLineColor,S=void 0===E?"#999999":E,G=e.isInteractive,x=void 0===G||G,B=e.onClick,P=void 0===B?function(){}:B,N=e.onMouseMove,I=void 0===N?function(){}:N,D=e.tooltip,K=t(null),V=a(),A=d(o,i,u),J=A.margin,Q=A.outerWidth,U=A.outerHeight,X=z({width:o,height:i,projectionType:p,projectionScale:m,projectionTranslation:b,projectionRotation:R,fillColor:q,borderWidth:T,borderColor:W}),Y=X.projection,Z=X.graticule,$=X.path,_=X.getFillColor,ee=X.getBorderWidth,oe=X.getBorderColor;n((function(){if(K){K.current.width=Q*c,K.current.height=U*c;var o=K.current.getContext("2d");o.scale(c,c),o.fillStyle=V.background,o.fillRect(0,0,Q,U),o.translate(J.left,J.top),$.context(o),s.forEach((function(r){"graticule"===r?!0===F&&(o.lineWidth=L,o.strokeStyle=S,o.beginPath(),$(Z()),o.stroke()):"features"===r?f.forEach((function(e){o.beginPath(),$(e),o.fillStyle=_(e),o.fill();var r=ee(e);r>0&&(o.strokeStyle=oe(e),o.lineWidth=r,o.stroke())})):r(o,e)}))}}),[K,Q,U,J,c,V,$,Z,_,ee,oe,f,s]);var re=g(),ie=re.showTooltipFromEvent,te=re.hideTooltip,ne=r((function(e){if(x&&D){var o=le(e,K.current,f,Y);o?ie(H(D,{feature:o}),e):te(),I&&I(o||null,e)}}),[ie,te,x,D,K,f,Y]),ae=r((function(){return x&&te()}),[x,te]),ue=r((function(e){if(x&&P){var o=le(e,K.current,f,Y);o&&P(o,e)}}),[x,K,f,Y,P]);return H("canvas",{ref:K,width:Q*c,height:U*c,style:{width:Q,height:U,cursor:x?"auto":"normal"},onMouseMove:ne,onMouseLeave:ae,onClick:ue})}));de.displatName="GeoMapCanvas",de.propTypes=Q;var ce=f(de),fe=function(e){return H(s,{children:function(o){var r=o.width,i=o.height;return H(ce,I({width:r,height:i},e))}})},se=o((function(e){var o=e.width,t=e.height,n=e.margin,u=e.features,l=e.data,f=e.match,s=void 0===f?"id":f,h=e.label,v=void 0===h?"id":h,m=e.value,C=void 0===m?"value":m,b=e.valueFormat,y=e.projectionType,R=void 0===y?"mercator":y,j=e.projectionScale,q=void 0===j?100:j,w=e.projectionTranslation,T=void 0===w?[.5,.5]:w,M=e.projectionRotation,W=void 0===M?[0,0,0]:M,k=e.colors,F=void 0===k?"PuBuGn":k,O=e.domain,L=e.unknownColor,E=void 0===L?"#999":L,S=e.borderWidth,G=void 0===S?0:S,x=e.borderColor,B=void 0===x?"#000000":x,N=e.enableGraticule,D=void 0!==N&&N,A=e.graticuleLineWidth,J=void 0===A?.5:A,Q=e.graticuleLineColor,U=void 0===Q?"#999999":Q,X=e.layers,Y=void 0===X?["graticule","features","legends"]:X,Z=e.legends,$=void 0===Z?[]:Z,_=e.isInteractive,ee=void 0===_||_,oe=e.onClick,re=void 0===oe?function(){}:oe,ne=e.tooltip,ae=void 0===ne?V:ne,ue=e.role,le=void 0===ue?"img":ue,de=e.defs,ce=void 0===de?[]:de,fe=e.fill,se=void 0===fe?[]:fe,he=d(o,t,n),pe=he.margin,ve=he.outerWidth,ge=he.outerHeight,me=z({width:o,height:t,projectionType:R,projectionScale:q,projectionTranslation:T,projectionRotation:W,fillColor:function(){},borderWidth:G,borderColor:B}),Ce=me.graticule,be=me.path,ye=me.getBorderWidth,Re=me.getBorderColor,je=K({features:u,data:l,match:s,label:v,value:C,valueFormat:b,colors:F,unknownColor:E,domain:O}),qe=je.getFillColor,we=je.boundFeatures,Te=je.legendData,Me=a(),We=p(ce,we,se,{dataKey:"data",targetKey:"fill"}),ke=g(),Fe=ke.showTooltipFromEvent,Oe=ke.hideTooltip,Le=r((function(e,o){return ee&&re&&re(e,o)}),[ee,re]),Ee=r((function(e,o){return ee&&ae&&Fe(H(ae,{feature:e}),o)}),[ee,Fe,ae]),Se=r((function(e,o){return ee&&ae&&Fe(H(ae,{feature:e}),o)}),[ee,Fe,ae]),Ge=r((function(){return ee&&Oe()}),[ee,Oe]);return H(c,{width:ve,height:ge,margin:pe,theme:Me,defs:We,role:le,children:Y.map((function(e,r){return"graticule"===e?!0!==D?null:H(ie,{path:be,graticule:Ce,lineWidth:J,lineColor:U},"graticule"):"features"===e?H(i,{children:we.map((function(e){return H(te,{feature:e,path:be,fillColor:qe(e),borderWidth:ye(e),borderColor:Re(e),onMouseEnter:Ee,onMouseMove:Se,onMouseLeave:Ge,onClick:Le},e.id)}))},"features"):"legends"===e?$.map((function(e,r){return H(P,I({containerWidth:o,containerHeight:t,data:Te},e),r)})):H(i,{children:e({})},r)}))})}));se.displayName="Choropleth",se.propTypes=X;var he=f(se),pe=function(e){return H(s,{children:function(o){var r=o.width,i=o.height;return H(he,I({width:r,height:i},e))}})},ve=function(e,o,r,i){var t=h(o,e),n=t[0],a=t[1];return r.find((function(e){return x(e,i.invert([n,a]))}))},ge=o((function(e){var o=e.width,i=e.height,u=e.margin,l=e.pixelRatio,c=void 0===l?"undefined"!=typeof window&&window.devicePixelRatio||1:l,f=e.features,s=e.data,h=e.match,p=void 0===h?"id":h,v=e.label,m=void 0===v?"id":v,C=e.value,b=void 0===C?"value":C,y=e.valueFormat,R=e.projectionType,j=void 0===R?"mercator":R,q=e.projectionScale,w=void 0===q?100:q,T=e.projectionTranslation,M=void 0===T?[.5,.5]:T,W=e.projectionRotation,k=void 0===W?[0,0,0]:W,F=e.colors,O=void 0===F?"PuBuGn":F,L=e.domain,E=e.unknownColor,S=void 0===E?"#999":E,G=e.borderWidth,x=void 0===G?0:G,B=e.borderColor,P=void 0===B?"#000000":B,D=e.enableGraticule,A=void 0!==D&&D,J=e.graticuleLineWidth,Q=void 0===J?.5:J,U=e.graticuleLineColor,X=void 0===U?"#999999":U,Y=e.layers,Z=void 0===Y?["graticule","features","legends"]:Y,$=e.legends,_=void 0===$?[]:$,ee=e.isInteractive,oe=void 0===ee||ee,re=e.onClick,ie=void 0===re?function(){}:re,te=e.onMouseMove,ne=void 0===te?function(){}:te,ae=e.tooltip,ue=void 0===ae?V:ae,le=t(null),de=a(),ce=d(o,i,u),fe=ce.margin,se=ce.outerWidth,he=ce.outerHeight,pe=z({width:o,height:i,projectionType:j,projectionScale:w,projectionTranslation:M,projectionRotation:k,fillColor:function(){},borderWidth:x,borderColor:P}),ge=pe.projection,me=pe.graticule,Ce=pe.path,be=pe.getBorderWidth,ye=pe.getBorderColor,Re=K({features:f,data:s,match:p,label:m,value:b,valueFormat:y,colors:O,unknownColor:S,domain:L}),je=Re.getFillColor,qe=Re.boundFeatures,we=Re.legendData;n((function(){if(le){le.current.width=se*c,le.current.height=he*c;var e=le.current.getContext("2d");e.scale(c,c),e.fillStyle=de.background,e.fillRect(0,0,se,he),e.translate(fe.left,fe.top),Ce.context(e),Z.forEach((function(r){"graticule"===r?!0===A&&(e.lineWidth=Q,e.strokeStyle=X,e.beginPath(),Ce(me()),e.stroke()):"features"===r?qe.forEach((function(o){e.beginPath(),Ce(o),e.fillStyle=je(o),e.fill();var r=be(o);r>0&&(e.strokeStyle=ye(o),e.lineWidth=r,e.stroke())})):"legends"===r&&_.forEach((function(r){N(e,I({},r,{data:we,containerWidth:o,containerHeight:i,theme:de}))}))}))}}),[le,se,he,fe,c,de,Ce,me,je,be,ye,qe,_,Z]);var Te=g(),Me=Te.showTooltipFromEvent,We=Te.hideTooltip,ke=r((function(e){if(oe&&ue){var o=ve(e,le.current,qe,ge);o?Me(H(ue,{feature:o}),e):We(),ne&&ne(o||null,e)}}),[Me,We,oe,ue,le,qe,ge]),Fe=r((function(){return oe&&We()}),[oe,We]),Oe=r((function(e){if(oe&&ie){var o=ve(e,le.current,qe,ge);o&&ie(o,e)}}),[oe,le,qe,ge,ie]);return H("canvas",{ref:le,width:se*c,height:he*c,style:{width:se,height:he,cursor:oe?"auto":"normal"},onMouseMove:ke,onMouseLeave:Fe,onClick:Oe})}));ge.displayName="ChoroplethCanvas",ge.propTypes=Y;var me=f(ge),Ce=function(e){return H(s,{children:function(o){var r=o.width,i=o.height;return H(me,I({width:r,height:i},e))}})};export{he as Choropleth,me as ChoroplethCanvas,re as ChoroplethCanvasDefaultProps,Y as ChoroplethCanvasPropTypes,oe as ChoroplethDefaultProps,X as ChoroplethPropTypes,ae as GeoMap,ce as GeoMapCanvas,_ as GeoMapCanvasDefaultProps,Q as GeoMapCanvasPropTypes,$ as GeoMapDefaultProps,J as GeoMapPropTypes,pe as ResponsiveChoropleth,Ce as ResponsiveChoroplethCanvas,ue as ResponsiveGeoMap,fe as ResponsiveGeoMapCanvas,D as projectionById,K as useChoropleth,z as useGeoMap};
//# sourceMappingURL=nivo-geo.es.js.map
