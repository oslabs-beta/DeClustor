"use strict";var e=require("react"),o=require("@nivo/core"),r=require("@nivo/tooltip"),i=require("prop-types"),t=require("@nivo/colors"),n=require("lodash/isFunction"),a=require("lodash/get"),u=require("d3-format"),l=require("d3-geo"),s=require("@nivo/legends"),d=require("react/jsx-runtime");function c(){return c=Object.assign?Object.assign.bind():function(e){for(var o=1;o<arguments.length;o++){var r=arguments[o];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},c.apply(this,arguments)}var p={azimuthalEqualArea:l.geoAzimuthalEqualArea,azimuthalEquidistant:l.geoAzimuthalEquidistant,gnomonic:l.geoGnomonic,orthographic:l.geoOrthographic,stereographic:l.geoStereographic,equalEarth:l.geoEqualEarth,equirectangular:l.geoEquirectangular,mercator:l.geoMercator,transverseMercator:l.geoTransverseMercator,naturalEarth1:l.geoNaturalEarth1},f=function(r){var i=r.width,n=r.height,a=r.projectionType,u=r.projectionScale,s=r.projectionTranslation,d=r.projectionRotation,c=r.fillColor,f=r.borderWidth,h=r.borderColor,v=e.useMemo((function(){return p[a]().scale(u).translate([i*s[0],n*s[1]]).rotate(d)}),[i,n,a,u,s[0],s[1],d[0],d[1],d[2]]),g=e.useMemo((function(){return l.geoPath(v)}),[v]),m=e.useMemo((function(){return l.geoGraticule()})),C=o.useTheme(),b=e.useMemo((function(){return"function"==typeof f?f:function(){return f}}),[f]),j=t.useInheritedColor(h,C),y=e.useMemo((function(){return"function"==typeof c?c:function(){return c}}),[c]);return{projection:v,path:g,graticule:m,getBorderWidth:b,getBorderColor:j,getFillColor:y}},h=function(r){var i=r.features,t=r.data,l=r.match,d=r.label,p=r.value,f=r.valueFormat,h=r.colors,v=r.unknownColor,g=r.domain,m=e.useMemo((function(){return n(l)?l:function(e,o){var r=a(e,l),i=a(o,l);return r&&r===i}}),[l]),C=e.useMemo((function(){return n(d)?d:function(e){return a(e,d)}}),[d]),b=e.useMemo((function(){return n(p)?p:function(e){return a(e,p)}}),[p]),j=e.useMemo((function(){return void 0===f?function(e){return e}:n(f)?f:u.format(f)}),[f]),y=e.useMemo((function(){return o.guessQuantizeColorScale(h).domain(g)}),[h,g]),R=e.useMemo((function(){return function(e){return void 0===e.value?v:y(e.value)}}),[y,v]),q=e.useMemo((function(){return i.map((function(e){var o=t.find((function(o){return m(e,o)})),r=b(o);if(o){var i=c({},e,{data:o,value:r,formattedValue:j(r)});return i.color=R(i),i.label=C(i),i}return e}))}),[i,t,m,b,j,R]),M=s.useQuantizeColorScaleLegendData({scale:y,valueFormat:j});return{colorScale:y,getFillColor:R,boundFeatures:q,valueFormatter:j,legendData:M}},v=e.memo((function(e){var o=e.feature;return void 0===o.data?null:d.jsx(r.BasicTooltip,{id:o.label,color:o.color,enableChip:!0,value:o.formattedValue})}));v.propTypes={feature:i.object.isRequired},v.displayName="ChoroplethTooltip";var g={features:i.arrayOf(i.shape({id:i.string.isRequired,type:i.oneOf(["Feature"]).isRequired,properties:i.object,geometry:i.object.isRequired})).isRequired,projectionType:i.oneOf(Object.keys(p)).isRequired,projectionScale:i.number.isRequired,projectionTranslation:i.arrayOf(i.number).isRequired,projectionRotation:i.arrayOf(i.number).isRequired,fillColor:i.oneOfType([i.string,i.func]).isRequired,borderWidth:i.oneOfType([i.number,i.func]).isRequired,borderColor:t.inheritedColorPropType.isRequired,enableGraticule:i.bool.isRequired,graticuleLineWidth:i.number.isRequired,graticuleLineColor:i.string.isRequired,isInteractive:i.bool.isRequired,onMouseEnter:i.func.isRequired,onMouseMove:i.func.isRequired,onMouseLeave:i.func.isRequired,onClick:i.func.isRequired,tooltip:i.any,layers:i.arrayOf(i.oneOfType([i.oneOf(["graticule","features"]),i.func])).isRequired},m=c({},g,{role:i.string.isRequired}),C=c({pixelRatio:i.number.isRequired},g),b={data:i.arrayOf(i.object).isRequired,match:i.oneOfType([i.string,i.func]).isRequired,label:i.oneOfType([i.string,i.func]).isRequired,value:i.oneOfType([i.string,i.func]).isRequired,valueFormat:i.oneOfType([i.string,i.func]),colors:o.quantizeColorScalePropType.isRequired,domain:i.arrayOf(i.number).isRequired,unknownColor:i.string.isRequired,layers:i.arrayOf(i.oneOfType([i.oneOf(["graticule","features","legends"]),i.func])).isRequired},j=c({},m,b,{role:i.string.isRequired}),y=c({},C,b),R={projectionType:"mercator",projectionScale:100,projectionTranslation:[.5,.5],projectionRotation:[0,0,0],enableGraticule:!1,graticuleLineWidth:.5,graticuleLineColor:"#999999",fillColor:"#dddddd",borderWidth:0,borderColor:"#000000",isInteractive:!0,onMouseEnter:function(){},onMouseLeave:function(){},onMouseMove:function(){},onClick:function(){},layers:["graticule","features"],legends:[],fill:[],defs:[]},q=c({},R,{role:"img"}),M=c({},R,{pixelRatio:"undefined"!=typeof window&&window.devicePixelRatio||1}),T={match:"id",label:"id",value:"value",colors:"PuBuGn",unknownColor:"#999",tooltip:v,layers:["graticule","features","legends"]},x=c({},q,T,{role:"img"}),w=c({},M,T),k=e.memo((function(e){var o=e.path,r=e.graticule,i=e.lineWidth,t=e.lineColor;return d.jsx("path",{fill:"none",strokeWidth:i,stroke:t,d:o(r())})}));k.propTypes={path:i.func.isRequired,graticule:i.func.isRequired,lineWidth:i.number.isRequired,lineColor:i.string.isRequired},k.displayName="GeoGraticule";var W=e.memo((function(e){var o,r=e.feature,i=e.path,t=e.fillColor,n=e.borderWidth,a=e.borderColor,u=e.onClick,l=e.onMouseEnter,s=e.onMouseMove,c=e.onMouseLeave;return d.jsx("path",{fill:null!=(o=null==r?void 0:r.fill)?o:t,strokeWidth:n,stroke:a,strokeLinejoin:"bevel",d:i(r),onMouseEnter:function(e){return l(r,e)},onMouseMove:function(e){return s(r,e)},onMouseLeave:function(e){return c(r,e)},onClick:function(e){return u(r,e)}},r.id)}));W.propTypes={feature:i.shape({id:i.string.isRequired,type:i.oneOf(["Feature"]).isRequired,properties:i.object,geometry:i.object.isRequired}).isRequired,path:i.func.isRequired,fillColor:i.string.isRequired,borderWidth:i.number.isRequired,borderColor:i.string.isRequired,onMouseEnter:i.func.isRequired,onMouseMove:i.func.isRequired,onMouseLeave:i.func.isRequired,onClick:i.func.isRequired},W.displayName="GeoMapFeature";var F=e.memo((function(i){var t=i.width,n=i.height,a=i.margin,u=i.features,l=i.layers,s=void 0===l?["graticule","features"]:l,c=i.projectionType,p=void 0===c?"mercator":c,h=i.projectionScale,v=void 0===h?100:h,g=i.projectionTranslation,m=void 0===g?[.5,.5]:g,C=i.projectionRotation,b=void 0===C?[0,0,0]:C,j=i.fillColor,y=void 0===j?"#dddddd":j,R=i.borderWidth,q=void 0===R?0:R,M=i.borderColor,T=void 0===M?"#000000":M,x=i.enableGraticule,w=void 0!==x&&x,F=i.graticuleLineWidth,E=void 0===F?.5:F,S=i.graticuleLineColor,O=void 0===S?"#999999":S,G=i.isInteractive,L=void 0===G||G,P=i.onClick,B=void 0===P?function(){}:P,D=i.tooltip,I=i.role,N=void 0===I?"img":I,z=o.useDimensions(t,n,a),H=z.margin,A=z.outerWidth,K=z.outerHeight,Q=f({width:t,height:n,projectionType:p,projectionScale:v,projectionTranslation:m,projectionRotation:b,fillColor:y,borderWidth:q,borderColor:T}),V=Q.graticule,J=Q.path,U=Q.getFillColor,X=Q.getBorderWidth,Y=Q.getBorderColor,Z=o.useTheme(),$=r.useTooltip(),_=$.showTooltipFromEvent,ee=$.hideTooltip,oe=e.useCallback((function(e,o){return L&&B&&B(e,o)}),[L,B]),re=e.useCallback((function(e,o){return L&&D&&_(d.jsx(D,{feature:e}),o)}),[L,_,D]),ie=e.useCallback((function(e,o){return L&&D&&_(d.jsx(D,{feature:e}),o)}),[L,_,D]),te=e.useCallback((function(){return L&&ee()}),[L,ee]);return d.jsx(o.SvgWrapper,{width:A,height:K,margin:H,theme:Z,role:N,children:s.map((function(o,r){return"graticule"===o?!0!==w?null:d.jsx(k,{path:J,graticule:V,lineWidth:E,lineColor:O},"graticule"):"features"===o?d.jsx(e.Fragment,{children:u.map((function(e){return d.jsx(W,{feature:e,path:J,fillColor:U(e),borderWidth:X(e),borderColor:Y(e),onMouseEnter:re,onMouseMove:ie,onMouseLeave:te,onClick:oe},e.id)}))},"features"):d.jsx(e.Fragment,{children:o(i)},r)}))})}));F.displayName="GeoMap",F.propTypes=m;var E=o.withContainer(F),S=function(e,r,i,t){var n=o.getRelativeCursor(r,e),a=n[0],u=n[1];return i.find((function(e){return l.geoContains(e,t.invert([a,u]))}))},O=e.memo((function(i){var t=i.width,n=i.height,a=i.margin,u=i.pixelRatio,l=void 0===u?"undefined"!=typeof window&&window.devicePixelRatio||1:u,s=i.features,c=i.layers,p=i.projectionType,h=void 0===p?"mercator":p,v=i.projectionScale,g=void 0===v?100:v,m=i.projectionTranslation,C=void 0===m?[.5,.5]:m,b=i.projectionRotation,j=void 0===b?[0,0,0]:b,y=i.fillColor,R=void 0===y?"#dddddd":y,q=i.borderWidth,M=void 0===q?0:q,T=i.borderColor,x=void 0===T?"#000000":T,w=i.enableGraticule,k=void 0!==w&&w,W=i.graticuleLineWidth,F=void 0===W?.5:W,E=i.graticuleLineColor,O=void 0===E?"#999999":E,G=i.isInteractive,L=void 0===G||G,P=i.onClick,B=void 0===P?function(){}:P,D=i.onMouseMove,I=void 0===D?function(){}:D,N=i.tooltip,z=e.useRef(null),H=o.useTheme(),A=o.useDimensions(t,n,a),K=A.margin,Q=A.outerWidth,V=A.outerHeight,J=f({width:t,height:n,projectionType:h,projectionScale:g,projectionTranslation:C,projectionRotation:j,fillColor:R,borderWidth:M,borderColor:x}),U=J.projection,X=J.graticule,Y=J.path,Z=J.getFillColor,$=J.getBorderWidth,_=J.getBorderColor;e.useEffect((function(){if(z){z.current.width=Q*l,z.current.height=V*l;var e=z.current.getContext("2d");e.scale(l,l),e.fillStyle=H.background,e.fillRect(0,0,Q,V),e.translate(K.left,K.top),Y.context(e),c.forEach((function(o){"graticule"===o?!0===k&&(e.lineWidth=F,e.strokeStyle=O,e.beginPath(),Y(X()),e.stroke()):"features"===o?s.forEach((function(o){e.beginPath(),Y(o),e.fillStyle=Z(o),e.fill();var r=$(o);r>0&&(e.strokeStyle=_(o),e.lineWidth=r,e.stroke())})):o(e,i)}))}}),[z,Q,V,K,l,H,Y,X,Z,$,_,s,c]);var ee=r.useTooltip(),oe=ee.showTooltipFromEvent,re=ee.hideTooltip,ie=e.useCallback((function(e){if(L&&N){var o=S(e,z.current,s,U);o?oe(d.jsx(N,{feature:o}),e):re(),I&&I(o||null,e)}}),[oe,re,L,N,z,s,U]),te=e.useCallback((function(){return L&&re()}),[L,re]),ne=e.useCallback((function(e){if(L&&B){var o=S(e,z.current,s,U);o&&B(o,e)}}),[L,z,s,U,B]);return d.jsx("canvas",{ref:z,width:Q*l,height:V*l,style:{width:Q,height:V,cursor:L?"auto":"normal"},onMouseMove:ie,onMouseLeave:te,onClick:ne})}));O.displatName="GeoMapCanvas",O.propTypes=C;var G=o.withContainer(O),L=e.memo((function(i){var t=i.width,n=i.height,a=i.margin,u=i.features,l=i.data,p=i.match,g=void 0===p?"id":p,m=i.label,C=void 0===m?"id":m,b=i.value,j=void 0===b?"value":b,y=i.valueFormat,R=i.projectionType,q=void 0===R?"mercator":R,M=i.projectionScale,T=void 0===M?100:M,x=i.projectionTranslation,w=void 0===x?[.5,.5]:x,F=i.projectionRotation,E=void 0===F?[0,0,0]:F,S=i.colors,O=void 0===S?"PuBuGn":S,G=i.domain,L=i.unknownColor,P=void 0===L?"#999":L,B=i.borderWidth,D=void 0===B?0:B,I=i.borderColor,N=void 0===I?"#000000":I,z=i.enableGraticule,H=void 0!==z&&z,A=i.graticuleLineWidth,K=void 0===A?.5:A,Q=i.graticuleLineColor,V=void 0===Q?"#999999":Q,J=i.layers,U=void 0===J?["graticule","features","legends"]:J,X=i.legends,Y=void 0===X?[]:X,Z=i.isInteractive,$=void 0===Z||Z,_=i.onClick,ee=void 0===_?function(){}:_,oe=i.tooltip,re=void 0===oe?v:oe,ie=i.role,te=void 0===ie?"img":ie,ne=i.defs,ae=void 0===ne?[]:ne,ue=i.fill,le=void 0===ue?[]:ue,se=o.useDimensions(t,n,a),de=se.margin,ce=se.outerWidth,pe=se.outerHeight,fe=f({width:t,height:n,projectionType:q,projectionScale:T,projectionTranslation:w,projectionRotation:E,fillColor:function(){},borderWidth:D,borderColor:N}),he=fe.graticule,ve=fe.path,ge=fe.getBorderWidth,me=fe.getBorderColor,Ce=h({features:u,data:l,match:g,label:C,value:j,valueFormat:y,colors:O,unknownColor:P,domain:G}),be=Ce.getFillColor,je=Ce.boundFeatures,ye=Ce.legendData,Re=o.useTheme(),qe=o.bindDefs(ae,je,le,{dataKey:"data",targetKey:"fill"}),Me=r.useTooltip(),Te=Me.showTooltipFromEvent,xe=Me.hideTooltip,we=e.useCallback((function(e,o){return $&&ee&&ee(e,o)}),[$,ee]),ke=e.useCallback((function(e,o){return $&&re&&Te(d.jsx(re,{feature:e}),o)}),[$,Te,re]),We=e.useCallback((function(e,o){return $&&re&&Te(d.jsx(re,{feature:e}),o)}),[$,Te,re]),Fe=e.useCallback((function(){return $&&xe()}),[$,xe]);return d.jsx(o.SvgWrapper,{width:ce,height:pe,margin:de,theme:Re,defs:qe,role:te,children:U.map((function(o,r){return"graticule"===o?!0!==H?null:d.jsx(k,{path:ve,graticule:he,lineWidth:K,lineColor:V},"graticule"):"features"===o?d.jsx(e.Fragment,{children:je.map((function(e){return d.jsx(W,{feature:e,path:ve,fillColor:be(e),borderWidth:ge(e),borderColor:me(e),onMouseEnter:ke,onMouseMove:We,onMouseLeave:Fe,onClick:we},e.id)}))},"features"):"legends"===o?Y.map((function(e,o){return d.jsx(s.BoxLegendSvg,c({containerWidth:t,containerHeight:n,data:ye},e),o)})):d.jsx(e.Fragment,{children:o({})},r)}))})}));L.displayName="Choropleth",L.propTypes=j;var P=o.withContainer(L),B=function(e,r,i,t){var n=o.getRelativeCursor(r,e),a=n[0],u=n[1];return i.find((function(e){return l.geoContains(e,t.invert([a,u]))}))},D=e.memo((function(i){var t=i.width,n=i.height,a=i.margin,u=i.pixelRatio,l=void 0===u?"undefined"!=typeof window&&window.devicePixelRatio||1:u,p=i.features,g=i.data,m=i.match,C=void 0===m?"id":m,b=i.label,j=void 0===b?"id":b,y=i.value,R=void 0===y?"value":y,q=i.valueFormat,M=i.projectionType,T=void 0===M?"mercator":M,x=i.projectionScale,w=void 0===x?100:x,k=i.projectionTranslation,W=void 0===k?[.5,.5]:k,F=i.projectionRotation,E=void 0===F?[0,0,0]:F,S=i.colors,O=void 0===S?"PuBuGn":S,G=i.domain,L=i.unknownColor,P=void 0===L?"#999":L,D=i.borderWidth,I=void 0===D?0:D,N=i.borderColor,z=void 0===N?"#000000":N,H=i.enableGraticule,A=void 0!==H&&H,K=i.graticuleLineWidth,Q=void 0===K?.5:K,V=i.graticuleLineColor,J=void 0===V?"#999999":V,U=i.layers,X=void 0===U?["graticule","features","legends"]:U,Y=i.legends,Z=void 0===Y?[]:Y,$=i.isInteractive,_=void 0===$||$,ee=i.onClick,oe=void 0===ee?function(){}:ee,re=i.onMouseMove,ie=void 0===re?function(){}:re,te=i.tooltip,ne=void 0===te?v:te,ae=e.useRef(null),ue=o.useTheme(),le=o.useDimensions(t,n,a),se=le.margin,de=le.outerWidth,ce=le.outerHeight,pe=f({width:t,height:n,projectionType:T,projectionScale:w,projectionTranslation:W,projectionRotation:E,fillColor:function(){},borderWidth:I,borderColor:z}),fe=pe.projection,he=pe.graticule,ve=pe.path,ge=pe.getBorderWidth,me=pe.getBorderColor,Ce=h({features:p,data:g,match:C,label:j,value:R,valueFormat:q,colors:O,unknownColor:P,domain:G}),be=Ce.getFillColor,je=Ce.boundFeatures,ye=Ce.legendData;e.useEffect((function(){if(ae){ae.current.width=de*l,ae.current.height=ce*l;var e=ae.current.getContext("2d");e.scale(l,l),e.fillStyle=ue.background,e.fillRect(0,0,de,ce),e.translate(se.left,se.top),ve.context(e),X.forEach((function(o){"graticule"===o?!0===A&&(e.lineWidth=Q,e.strokeStyle=J,e.beginPath(),ve(he()),e.stroke()):"features"===o?je.forEach((function(o){e.beginPath(),ve(o),e.fillStyle=be(o),e.fill();var r=ge(o);r>0&&(e.strokeStyle=me(o),e.lineWidth=r,e.stroke())})):"legends"===o&&Z.forEach((function(o){s.renderLegendToCanvas(e,c({},o,{data:ye,containerWidth:t,containerHeight:n,theme:ue}))}))}))}}),[ae,de,ce,se,l,ue,ve,he,be,ge,me,je,Z,X]);var Re=r.useTooltip(),qe=Re.showTooltipFromEvent,Me=Re.hideTooltip,Te=e.useCallback((function(e){if(_&&ne){var o=B(e,ae.current,je,fe);o?qe(d.jsx(ne,{feature:o}),e):Me(),ie&&ie(o||null,e)}}),[qe,Me,_,ne,ae,je,fe]),xe=e.useCallback((function(){return _&&Me()}),[_,Me]),we=e.useCallback((function(e){if(_&&oe){var o=B(e,ae.current,je,fe);o&&oe(o,e)}}),[_,ae,je,fe,oe]);return d.jsx("canvas",{ref:ae,width:de*l,height:ce*l,style:{width:de,height:ce,cursor:_?"auto":"normal"},onMouseMove:Te,onMouseLeave:xe,onClick:we})}));D.displayName="ChoroplethCanvas",D.propTypes=y;var I=o.withContainer(D);exports.Choropleth=P,exports.ChoroplethCanvas=I,exports.ChoroplethCanvasDefaultProps=w,exports.ChoroplethCanvasPropTypes=y,exports.ChoroplethDefaultProps=x,exports.ChoroplethPropTypes=j,exports.GeoMap=E,exports.GeoMapCanvas=G,exports.GeoMapCanvasDefaultProps=M,exports.GeoMapCanvasPropTypes=C,exports.GeoMapDefaultProps=q,exports.GeoMapPropTypes=m,exports.ResponsiveChoropleth=function(e){return d.jsx(o.ResponsiveWrapper,{children:function(o){var r=o.width,i=o.height;return d.jsx(P,c({width:r,height:i},e))}})},exports.ResponsiveChoroplethCanvas=function(e){return d.jsx(o.ResponsiveWrapper,{children:function(o){var r=o.width,i=o.height;return d.jsx(I,c({width:r,height:i},e))}})},exports.ResponsiveGeoMap=function(e){return d.jsx(o.ResponsiveWrapper,{children:function(o){var r=o.width,i=o.height;return d.jsx(E,c({width:r,height:i},e))}})},exports.ResponsiveGeoMapCanvas=function(e){return d.jsx(o.ResponsiveWrapper,{children:function(o){var r=o.width,i=o.height;return d.jsx(G,c({width:r,height:i},e))}})},exports.projectionById=p,exports.useChoropleth=h,exports.useGeoMap=f;
//# sourceMappingURL=nivo-geo.cjs.js.map
